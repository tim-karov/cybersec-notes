# HTB: "Writeup" Machine Walktrough

- **Difficulty:** Easy
- **Дата:** 17.01.2026
- **Цель:** Практика

## 1. Recon & Enumeration
Nmap `nmap -sC -sV -v $ip`, получаем 2 открытых порта `22 (SSH)`, `80 (HTTP)`. Nmap также подсветил нам некую директорию `/writeup`. Видим, что это персональный сайт, на котором автор пишет про прохождение машин на площадках. Сайт абсолютно без какого-либо оформления и дополнительной информации. Зайдя в исходный код страницы, нахожу, что сайт работает на `CMS Made Simple - Copyright (C) 2004-2019. All rights reserved.`. Об версии данной CMS информации нет, чтож, идем в Google.

Предположив, что сайт работает на последней версии 2019 года (v 2.2.8), находим [CVE-2019–9053](https://nvd.nist.gov/vuln/detail/CVE-2019-9053), в которой говорится, что с помощью специально сформированного URL-адреса можно осуществить неаутентифицированную слепую SQL-инъекцию по времени через параметр m1_idlist.

Кстати, для любителей метода перечислений и грубой силы, спешу вас расстроить, на этой машине этого сделать не получится, так как она оснащёна защитой от DoS-атак, предотвращающей перебор паролей. Я сам на эти грабли наступил.

## 2. Exploitation
На ExploitDB нашел подходящий [эксплойт](https://www.exploit-db.com/exploits/46635), который у меня никак не хотел запускаться, постоянно появлялись какие-то новые ошибки, тут я принял стратегическое решение переписать старый эксплойт под python3, найти который мы можете у меня в профиле — [cmsms-sqli](https://github.com/tim-karov/cmsms-sqli). Инструкция, как им пользоваться тоже идет в комплекте. Отработав, мы получаем следующий вывод:
```bash
Username: jkr
MD5: 62def4866937f08cc13bab43bb14e6f7
crack: hashcat -a 0 -m 20 '62def4866937f08cc13bab43bb14e6f7:5a599ef579066807' rockyou.txt
```
И так, эксплойт отработал что мы имеем на выходе? Мы имеем username, cоль и хеш пароля. Пробуем с помощью инструмента hashcat, и по готовой подсказке эксплойта, получиить пароль из хеша:
```bash
hashcat -a 0 -m 20 '62def4866937f08cc13bab43bb14e6f7:5a599ef579066807' rockyou.txt
```
Hashcat отработал, пароль получен, в итоге имеем креды: `jkr:raykayjay9`.

Nmap подсвеитл нам откртый `22 (SSH)`, подключаемся — успех! `find / -name "user.txt" 2>/dev/null` user-флаг в кармане, давайте поднимать привилегии.

## 3. Privilege Escalation


## Done
